<!DOCTYPE html>
<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/vega@6.2.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@6.1.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@7.0.2"></script>
</head>
<body>
  <div id="vis"/>
  <script>
    const spec = {
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "title": "Australians Speaking a Language Other than English at Home",
  "width": 800,
  "height": 500,
  "projection": {"type": "mercator"},
  "view": {"stroke": "black"},
  "layer": [
    {
      "data": {
        "url": "https://jowongx8.github.io/FIT3179/data/states.json",
        "format": {"type": "topojson", "feature": "STE_2021_AUST_GDA94"}
      },
      "transform": [
        {
          "lookup": "properties.STE_NAME21",
          "from": {
            "data": {
              "url": "https://jowongx8.github.io/FIT3179/data/language_by_state.csv"
            },
            "key": "State",
            "fields": ["Total", "English"]
          }
        },
        {"calculate": "datum.Total - datum.English", "as": "NonEnglish"},
        {
          "calculate": "(datum.Total - datum.English) / datum.Total * 100",
          "as": "PercentNonEnglish"
        }
      ],
      "mark": {"type": "geoshape"},
      "encoding": {
        "color": {
          "field": "PercentNonEnglish",
          "type": "quantitative",
          "scale": {"scheme": {"name": "blues", "count": 6}},
          "title": "% Non-English Speakers"
        },
        "tooltip": [
          {"field": "properties.STE_NAME21", "title": "State"},
          {"field": "Total", "title": "Total Population", "format": ","},
          {"field": "English", "title": "English Only", "format": ","},
          {
            "field": "NonEnglish",
            "title": "Non-English Speakers",
            "format": ","
          },
          {
            "field": "PercentNonEnglish",
            "title": "% Non-English",
            "format": ".2f"
          }
        ]
      }
    },
    {
      "data": {
        "url": "https://jowongx8.github.io/FIT3179/data/states.json",
        "format": {"type": "topojson", "feature": "ne_110m_graticules_10"}
      },
      "mark": {
        "type": "geoshape",
        "stroke": "lightgray",
        "strokeWidth": 0.5,
        "fill": null
      }
    },
    {
      "data": {
        "url": "https://jowongx8.github.io/FIT3179/data/states.json",
        "format": {"type": "topojson", "feature": "STE_2021_AUST_GDA94"}
      },
      "mark": {
        "type": "geoshape",
        "stroke": "black",
        "strokeWidth": 0.5,
        "fill": null
      }
    },
    {
      "data": {
        "values": [
          {"city": "Canberra", "lon": 149.13, "lat": -35.28},
          {"city": "Sydney", "lon": 151.21, "lat": -33.87},
          {"city": "Melbourne", "lon": 144.96, "lat": -37.81},
          {"city": "Brisbane", "lon": 153.03, "lat": -27.47},
          {"city": "Perth", "lon": 115.86, "lat": -31.95},
          {"city": "Adelaide", "lon": 138.6, "lat": -34.93},
          {"city": "Hobart", "lon": 147.33, "lat": -42.88},
          {"city": "Darwin", "lon": 130.84, "lat": -12.46}
        ]
      },
      "mark": {"type": "circle", "color": "red", "size": 60},
      "encoding": {
        "longitude": {"field": "lon", "type": "quantitative"},
        "latitude": {"field": "lat", "type": "quantitative"},
        "tooltip": {"field": "city"}
      }
    }
  ],
  "config": {}
};
    vegaEmbed("#vis", spec, {mode: "vega-lite"}).then(console.log).catch(console.warn);
  </script>
</body>
</html>